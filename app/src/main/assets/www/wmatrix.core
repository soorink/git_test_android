(function(){var PLATFORM_VERSION_BUILD_LABEL=wmatrixVersion;var require;var define;(function(){var modules={};var requireStack=[];var inProgressModules={};var SEPARATOR=".";function build(module){var factory=module.factory;var localRequire=function(id){var resultantId=id;if(id.charAt(0)==="."){resultantId=module.id.slice(0,module.id.lastIndexOf(SEPARATOR))+SEPARATOR+id.slice(2)}return require(resultantId)};module.exports={};delete module.factory;factory(localRequire,module.exports,module);return module.exports}require=function(id){if(!modules[id]){throw new Error("module "+id+" not found")}else if(id in inProgressModules){var cycle=requireStack.slice(inProgressModules[id]).join("->")+"->"+id;throw new Error("Cycle in require graph: "+cycle)}if(modules[id].factory){try{inProgressModules[id]=requireStack.length;requireStack.push(id);return build(modules[id])}finally{delete inProgressModules[id];requireStack.pop()}}return modules[id].exports};define=function(id,factory){if(Object.prototype.hasOwnProperty.call(modules,id)){throw new Error("module "+id+" already defined")}modules[id]={id:id,factory:factory}};define.remove=function(id){delete modules[id]};define.moduleMap=modules})();if(typeof module==="object"&&typeof require==="function"){module.exports.require=require;module.exports.define=define}define("wmatrix",function(require,exports,module){if(window.wmatrix&&!(window.wmatrix instanceof HTMLElement)){throw new Error("wmatrix already defined")}var channel=require("wmatrix/channel");var platform=require("wmatrix/platform");var m_document_addEventListener=document.addEventListener;var m_document_removeEventListener=document.removeEventListener;var m_window_addEventListener=window.addEventListener;var m_window_removeEventListener=window.removeEventListener;var documentEventHandlers={};var windowEventHandlers={};document.addEventListener=function(evt,handler,capture){var e=evt.toLowerCase();if(typeof documentEventHandlers[e]!=="undefined"){documentEventHandlers[e].subscribe(handler)}else{m_document_addEventListener.call(document,evt,handler,capture)}};window.addEventListener=function(evt,handler,capture){var e=evt.toLowerCase();if(typeof windowEventHandlers[e]!=="undefined"){windowEventHandlers[e].subscribe(handler)}else{m_window_addEventListener.call(window,evt,handler,capture)}};document.removeEventListener=function(evt,handler,capture){var e=evt.toLowerCase();if(typeof documentEventHandlers[e]!=="undefined"){documentEventHandlers[e].unsubscribe(handler)}else{m_document_removeEventListener.call(document,evt,handler,capture)}};window.removeEventListener=function(evt,handler,capture){var e=evt.toLowerCase();if(typeof windowEventHandlers[e]!=="undefined"){windowEventHandlers[e].unsubscribe(handler)}else{m_window_removeEventListener.call(window,evt,handler,capture)}};function createEvent(type,data){var event=document.createEvent("Events");event.initEvent(type,false,false);if(data){for(var i in data){if(Object.prototype.hasOwnProperty.call(data,i)){event[i]=data[i]}}}return event}var wmatrix={define:define,require:require,version:PLATFORM_VERSION_BUILD_LABEL,platformVersion:PLATFORM_VERSION_BUILD_LABEL,platformId:platform.id,addWindowEventHandler:function(event){return windowEventHandlers[event]=channel.create(event)},addStickyDocumentEventHandler:function(event){return documentEventHandlers[event]=channel.createSticky(event)},addDocumentEventHandler:function(event){return documentEventHandlers[event]=channel.create(event)},removeWindowEventHandler:function(event){delete windowEventHandlers[event]},removeDocumentEventHandler:function(event){delete documentEventHandlers[event]},getOriginalHandlers:function(){return{document:{addEventListener:m_document_addEventListener,removeEventListener:m_document_removeEventListener},window:{addEventListener:m_window_addEventListener,removeEventListener:m_window_removeEventListener}}},fireDocumentEvent:function(type,data,bNoDetach){var evt=createEvent(type,data);if(typeof documentEventHandlers[type]!=="undefined"){if(bNoDetach){documentEventHandlers[type].fire(evt)}else{setTimeout(function(){if(type==="wmatrixready"){document.dispatchEvent(evt)}documentEventHandlers[type].fire(evt)},0)}}else{document.dispatchEvent(evt)}},fireWindowEvent:function(type,data){var evt=createEvent(type,data);if(typeof windowEventHandlers[type]!=="undefined"){setTimeout(function(){windowEventHandlers[type].fire(evt)},0)}else{window.dispatchEvent(evt)}},callbackId:window.crypto.getRandomValues(new Uint32Array(1))[0],callbacks:{},callbackStatus:{NO_RESULT:0,OK:1,CLASS_NOT_FOUND_EXCEPTION:2,ILLEGAL_ACCESS_EXCEPTION:3,INSTANTIATION_EXCEPTION:4,MALFORMED_URL_EXCEPTION:5,IO_EXCEPTION:6,INVALID_ACTION:7,JSON_EXCEPTION:8,ERROR:9},callbackSuccess:function(callbackId,args){wmatrix.callbackFromNative(callbackId,true,args.status,[args.message],args.keepCallback)},callbackError:function(callbackId,args){wmatrix.callbackFromNative(callbackId,false,args.status,[args.message],args.keepCallback)},callbackFromNative:function(callbackId,isSuccess,status,args,keepCallback){try{var callback=wmatrix.callbacks[callbackId];if(callback){callback.callbackFunc&&callback.callbackFunc.apply(null,args);if(!keepCallback){delete wmatrix.callbacks[callbackId]}}}catch(err){var msg="Error in "+(isSuccess?"Success":"Error")+" callbackId: "+callbackId+" : "+err;console&&console.log&&console.log(msg);console&&console.log&&err.stack&&console.log(err.stack);wmatrix.fireWindowEvent("wmatrixcallbackerror",{message:msg});throw err}},addConstructor:function(func){channel.onJSReady.subscribe(function(){try{func()}catch(e){console.log("Failed to run constructor: "+e)}})}};module.exports=wmatrix});define("wmatrix/argscheck",function(require,exports,module){var utils=require("wmatrix/utils");var moduleExports=module.exports;var typeMap={A:"Array",D:"Date",N:"Number",S:"String",F:"Function",O:"Object"};function extractParamName(callee,argIndex){return/\(\s*([^)]*?)\s*\)/.exec(callee)[1].split(/\s*,\s*/)[argIndex]}function checkArgs(spec,functionName,args,opt_callee){if(!moduleExports.enableChecks){return}var errMsg=null;var typeName;for(var i=0;i<spec.length;++i){var c=spec.charAt(i);var cUpper=c.toUpperCase();var arg=args[i];if(c==="*"){continue}typeName=utils.typeName(arg);if((arg===null||arg===undefined)&&c===cUpper){continue}if(typeName!==typeMap[cUpper]){errMsg="Expected "+typeMap[cUpper];break}}if(errMsg){errMsg+=", but got "+typeName+".";errMsg='Wrong type for parameter "'+extractParamName(opt_callee||args.callee,i)+'" of '+functionName+": "+errMsg;if(typeof jasmine==="undefined"){console.error(errMsg)}throw TypeError(errMsg)}}function getValue(value,defaultValue){return value===undefined?defaultValue:value}moduleExports.checkArgs=checkArgs;moduleExports.getValue=getValue;moduleExports.enableChecks=true});define("wmatrix/base64",function(require,exports,module){var base64=exports;base64.fromArrayBuffer=function(arrayBuffer){var array=new Uint8Array(arrayBuffer);return uint8ToBase64(array)};base64.toArrayBuffer=function(str){var decodedStr=atob(str);var arrayBuffer=new ArrayBuffer(decodedStr.length);var array=new Uint8Array(arrayBuffer);for(var i=0,len=decodedStr.length;i<len;i++){array[i]=decodedStr.charCodeAt(i)}return arrayBuffer};var b64_6bit="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b64_12bit;var b64_12bitTable=function(){b64_12bit=[];for(var i=0;i<64;i++){for(var j=0;j<64;j++){b64_12bit[i*64+j]=b64_6bit[i]+b64_6bit[j]}}b64_12bitTable=function(){return b64_12bit};return b64_12bit};function uint8ToBase64(rawData){var numBytes=rawData.byteLength;var output="";var segment;var table=b64_12bitTable();for(var i=0;i<numBytes-2;i+=3){segment=(rawData[i]<<16)+(rawData[i+1]<<8)+rawData[i+2];output+=table[segment>>12];output+=table[segment&4095]}if(numBytes-i===2){segment=(rawData[i]<<16)+(rawData[i+1]<<8);output+=table[segment>>12];output+=b64_6bit[(segment&4095)>>6];output+="="}else if(numBytes-i===1){segment=rawData[i]<<16;output+=table[segment>>12];output+="=="}return output}});define("wmatrix/builder",function(require,exports,module){var utils=require("wmatrix/utils");function each(objects,func,context){for(var prop in objects){if(Object.prototype.hasOwnProperty.call(objects,prop)){func.apply(context,[objects[prop],prop])}}}function clobber(obj,key,value){var needsProperty=false;try{obj[key]=value}catch(e){needsProperty=true}if(needsProperty||obj[key]!==value){utils.defineGetter(obj,key,function(){return value})}}function assignOrWrapInDeprecateGetter(obj,key,value,message){if(message){utils.defineGetter(obj,key,function(){console.log(message);delete obj[key];clobber(obj,key,value);return value})}else{clobber(obj,key,value)}}function include(parent,objects,clobber,merge){each(objects,function(obj,key){try{var result=obj.path?require(obj.path):{};if(clobber){if(typeof parent[key]==="undefined"){assignOrWrapInDeprecateGetter(parent,key,result,obj.deprecated)}else if(typeof obj.path!=="undefined"){if(merge){recursiveMerge(parent[key],result)}else{assignOrWrapInDeprecateGetter(parent,key,result,obj.deprecated)}}result=parent[key]}else{if(typeof parent[key]==="undefined"){assignOrWrapInDeprecateGetter(parent,key,result,obj.deprecated)}else{result=parent[key]}}if(obj.children){include(result,obj.children,clobber,merge)}}catch(e){utils.alert("Exception building WMatrix JS globals: "+e+' for key "'+key+'"')}})}function recursiveMerge(target,src){for(var prop in src){if(Object.prototype.hasOwnProperty.call(src,prop)){if(target.prototype&&target.prototype.constructor===target){clobber(target.prototype,prop,src[prop])}else{if(typeof src[prop]==="object"&&typeof target[prop]==="object"){recursiveMerge(target[prop],src[prop])}else{clobber(target,prop,src[prop])}}}}}exports.buildIntoButDoNotClobber=function(objects,target){include(target,objects,false,false)};exports.buildIntoAndClobber=function(objects,target){include(target,objects,true,false)};exports.buildIntoAndMerge=function(objects,target){include(target,objects,true,true)};exports.recursiveMerge=recursiveMerge;exports.assignOrWrapInDeprecateGetter=assignOrWrapInDeprecateGetter});define("wmatrix/channel",function(require,exports,module){var utils=require("wmatrix/utils");var nextGuid=1;var Channel=function(type,sticky){this.type=type;this.handlers={};this.state=sticky?1:0;this.fireArgs=null;this.numHandlers=0;this.onHasSubscribersChange=null};var channel={join:function(h,c){var len=c.length;var i=len;var f=function(){if(!--i)h()};for(var j=0;j<len;j++){if(c[j].state===0){throw Error("Can only use join with sticky channels.")}c[j].subscribe(f)}if(!len)h()},create:function(type){return channel[type]=new Channel(type,false)},createSticky:function(type){return channel[type]=new Channel(type,true)},wmatrixReadyChannelsArray:[],wmatrixReadyChannelsMap:{},waitForInitialization:function(feature){if(feature){var c=channel[feature]||this.createSticky(feature);this.wmatrixReadyChannelsMap[feature]=c;this.wmatrixReadyChannelsArray.push(c)}},initializationComplete:function(feature){var c=this.wmatrixReadyChannelsMap[feature];if(c){c.fire()}}};function checkSubscriptionArgument(argument){if(typeof argument!=="function"&&typeof argument.handleEvent!=="function"){throw new Error("Must provide a function or an EventListener object "+"implementing the handleEvent interface.")}}Channel.prototype.subscribe=function(eventListenerOrFunction,eventListener){checkSubscriptionArgument(eventListenerOrFunction);var handleEvent,guid;if(eventListenerOrFunction&&typeof eventListenerOrFunction==="object"){handleEvent=eventListenerOrFunction.handleEvent;eventListener=eventListenerOrFunction}else{handleEvent=eventListenerOrFunction}if(this.state===2){handleEvent.apply(eventListener||this,this.fireArgs);return}guid=eventListenerOrFunction.observer_guid;if(typeof eventListener==="object"){handleEvent=utils.close(eventListener,handleEvent)}if(!guid){guid=""+nextGuid++}handleEvent.observer_guid=guid;eventListenerOrFunction.observer_guid=guid;if(!this.handlers[guid]){this.handlers[guid]=handleEvent;this.numHandlers++;if(this.numHandlers===1){this.onHasSubscribersChange&&this.onHasSubscribersChange()}}};Channel.prototype.unsubscribe=function(eventListenerOrFunction){checkSubscriptionArgument(eventListenerOrFunction);var handleEvent,guid,handler;if(eventListenerOrFunction&&typeof eventListenerOrFunction==="object"){handleEvent=eventListenerOrFunction.handleEvent}else{handleEvent=eventListenerOrFunction}guid=handleEvent.observer_guid;handler=this.handlers[guid];if(handler){delete this.handlers[guid];this.numHandlers--;if(this.numHandlers===0){this.onHasSubscribersChange&&this.onHasSubscribersChange()}}};Channel.prototype.fire=function(e){var fireArgs=Array.prototype.slice.call(arguments);if(this.state===1){this.state=2;this.fireArgs=fireArgs}if(this.numHandlers){var toCall=[];for(var item in this.handlers){toCall.push(this.handlers[item])}for(var i=0;i<toCall.length;++i){toCall[i].apply(this,fireArgs)}if(this.state===2&&this.numHandlers){this.numHandlers=0;this.handlers={};this.onHasSubscribersChange&&this.onHasSubscribersChange()}}};channel.createSticky("onDOMContentLoaded");channel.createSticky("onNativeReady");channel.createSticky("onJSReady");channel.createSticky("onPluginsReady");channel.createSticky("onWMatrixReady");channel.create("onResume");channel.create("onPause");channel.waitForInitialization("onJSReady");channel.waitForInitialization("onDOMContentLoaded");module.exports=channel});if(typeof window.webkit=="undefined"){define("wmatrix/android/nativeapiprovider",function(require,exports,module){var nativeApi=this._wmatrixNative||require("wmatrix/android/promptbasednativeapi");var currentApi=nativeApi;module.exports={get:function(){return currentApi},setPreferPrompt:function(value){currentApi=value?require("wmatrix/android/promptbasednativeapi"):nativeApi},set:function(value){currentApi=value}}});define("wmatrix/android/promptbasednativeapi",function(require,exports,module){module.exports={exec:function(bridgeSecret,service,action,callbackId,argsJson){return prompt(argsJson,"gap:"+JSON.stringify([bridgeSecret,service,action,callbackId]))},setNativeToJsBridgeMode:function(bridgeSecret,value){prompt(value,"gap_bridge_mode:"+bridgeSecret)},retrieveJsMessages:function(bridgeSecret,fromOnlineEvent){return prompt(+fromOnlineEvent,"gap_poll:"+bridgeSecret)}}});define("wmatrix/exec",function(require,exports,module){var wmatrix=require("wmatrix"),nativeApiProvider=require("wmatrix/android/nativeapiprovider"),utils=require("wmatrix/utils"),base64=require("wmatrix/base64"),channel=require("wmatrix/channel"),jsToNativeModes={PROMPT:0,JS_OBJECT:1},nativeToJsModes={POLLING:0,LOAD_URL:1,ONLINE_EVENT:2,EVAL_BRIDGE:3},jsToNativeBridgeMode,nativeToJsBridgeMode=nativeToJsModes.EVAL_BRIDGE,pollEnabled=false,bridgeSecret=-1;var messagesFromNative=[];var isProcessing=false;var resolvedPromise=typeof Promise=="undefined"?null:Promise.resolve();var nextTick=resolvedPromise?function(fn){resolvedPromise.then(fn)}:function(fn){setTimeout(fn)};function androidExec(callback,service,action,args){if(bridgeSecret<0){throw new Error("exec() called without bridgeSecret")}if(jsToNativeBridgeMode===undefined){androidExec.setJsToNativeBridgeMode(jsToNativeModes.JS_OBJECT)}args=args||[];for(var i=0;i<args.length;i++){if(utils.typeName(args[i])=="ArrayBuffer"){args[i]=base64.fromArrayBuffer(args[i])}}var callbackId=service+wmatrix.callbackId++,argsJson=JSON.stringify(args);if(callback){wmatrix.callbacks[callbackId]={callbackFunc:callback}}var msgs=nativeApiProvider.get().exec(bridgeSecret,service,action,callbackId,argsJson);if(jsToNativeBridgeMode==jsToNativeModes.JS_OBJECT&&msgs==="Null arguments."){androidExec.setJsToNativeBridgeMode(jsToNativeModes.PROMPT);androidExec(callback,service,action,args);androidExec.setJsToNativeBridgeMode(jsToNativeModes.JS_OBJECT)}else if(msgs){messagesFromNative.push(msgs);nextTick(processMessages)}}androidExec.init=function(){bridgeSecret=+prompt("","gap_init:"+nativeToJsBridgeMode);channel.onNativeReady.fire()};function pollOnceFromOnlineEvent(){pollOnce(true)}function pollOnce(opt_fromOnlineEvent){if(bridgeSecret<0){return}var msgs=nativeApiProvider.get().retrieveJsMessages(bridgeSecret,!!opt_fromOnlineEvent);if(msgs){messagesFromNative.push(msgs);processMessages()}}function pollingTimerFunc(){if(pollEnabled){pollOnce();setTimeout(pollingTimerFunc,50)}}function hookOnlineApis(){function proxyEvent(e){wmatrix.fireWindowEvent(e.type)}window.addEventListener("online",pollOnceFromOnlineEvent,false);window.addEventListener("offline",pollOnceFromOnlineEvent,false);wmatrix.addWindowEventHandler("online");wmatrix.addWindowEventHandler("offline");document.addEventListener("online",proxyEvent,false);document.addEventListener("offline",proxyEvent,false)}hookOnlineApis();androidExec.jsToNativeModes=jsToNativeModes;androidExec.nativeToJsModes=nativeToJsModes;androidExec.setJsToNativeBridgeMode=function(mode){if(mode==jsToNativeModes.JS_OBJECT&&!window._wmatrixNative){mode=jsToNativeModes.PROMPT}nativeApiProvider.setPreferPrompt(mode==jsToNativeModes.PROMPT);jsToNativeBridgeMode=mode};androidExec.setNativeToJsBridgeMode=function(mode){if(mode==nativeToJsBridgeMode){return}if(nativeToJsBridgeMode==nativeToJsModes.POLLING){pollEnabled=false}nativeToJsBridgeMode=mode;if(bridgeSecret>=0){nativeApiProvider.get().setNativeToJsBridgeMode(bridgeSecret,mode)}if(mode==nativeToJsModes.POLLING){pollEnabled=true;setTimeout(pollingTimerFunc,1)}};function buildPayload(payload,message){var payloadKind=message.charAt(0);if(payloadKind=="s"){payload.push(message.slice(1))}else if(payloadKind=="t"){payload.push(true)}else if(payloadKind=="f"){payload.push(false)}else if(payloadKind=="N"){payload.push(null)}else if(payloadKind=="n"){payload.push(+message.slice(1))}else if(payloadKind=="A"){var data=message.slice(1);payload.push(base64.toArrayBuffer(data))}else if(payloadKind=="S"){payload.push(window.atob(message.slice(1)))}else if(payloadKind=="M"){var multipartMessages=message.slice(1);while(multipartMessages!==""){var spaceIdx=multipartMessages.indexOf(" ");var msgLen=+multipartMessages.slice(0,spaceIdx);var multipartMessage=multipartMessages.substr(spaceIdx+1,msgLen);multipartMessages=multipartMessages.slice(spaceIdx+msgLen+1);buildPayload(payload,multipartMessage)}}else{payload.push(JSON.parse(message))}}function processMessage(message){var firstChar=message.charAt(0);if(firstChar=="S"||firstChar=="F"){var callback=firstChar=="S";var keepCallback=message.charAt(1)=="1";var spaceIdx=message.indexOf(" ",2);var status=+message.slice(2,spaceIdx);var nextSpaceIdx=message.indexOf(" ",spaceIdx+1);var callbackId=message.slice(spaceIdx+1,nextSpaceIdx);var payloadMessage=message.slice(nextSpaceIdx+1);var payload=[];buildPayload(payload,payloadMessage);wmatrix.callbackFromNative(callbackId,callback,status,payload,keepCallback)}else{console.log("processMessage failed: invalid message: "+JSON.stringify(message))}}function processMessages(){if(isProcessing){return}if(messagesFromNative.length===0){return}isProcessing=true;try{var msg=popMessageFromQueue();if(msg=="*"&&messagesFromNative.length===0){nextTick(pollOnce);return}processMessage(msg)}finally{isProcessing=false;if(messagesFromNative.length>0){nextTick(processMessages)}}}function popMessageFromQueue(){var messageBatch=messagesFromNative.shift();if(messageBatch=="*"){return"*"}var spaceIdx=messageBatch.indexOf(" ");var msgLen=+messageBatch.slice(0,spaceIdx);var message=messageBatch.substr(spaceIdx+1,msgLen);messageBatch=messageBatch.slice(spaceIdx+msgLen+1);if(messageBatch){messagesFromNative.unshift(messageBatch)}return message}module.exports=androidExec});define("wmatrix/platform",function(require,exports,module){var lastResumeEvent=null;module.exports={id:"android",bootstrap:function(){var channel=require("wmatrix/channel"),wmatrix=require("wmatrix"),exec=require("wmatrix/exec"),modulemapper=require("wmatrix/modulemapper");exec.init();modulemapper.clobbers("wmatrix/plugin/android/app","navigator.app");var APP_PLUGIN_NAME=Number(wmatrix.platformVersion.split(".")[2])>=6?"CoreAndroid":"App";var backButtonChannel=wmatrix.addDocumentEventHandler("backbutton");backButtonChannel.onHasSubscribersChange=function(){exec(null,APP_PLUGIN_NAME,"overrideBackbutton",[this.numHandlers==1])};wmatrix.addDocumentEventHandler("menubutton");wmatrix.addDocumentEventHandler("searchbutton");function bindButtonChannel(buttonName){var volumeButtonChannel=wmatrix.addDocumentEventHandler(buttonName+"button");volumeButtonChannel.onHasSubscribersChange=function(){exec(null,APP_PLUGIN_NAME,"overrideButton",[buttonName,this.numHandlers==1])}}bindButtonChannel("volumeup");bindButtonChannel("volumedown");var wmatrixAddEventListener=document.addEventListener;document.addEventListener=function(evt,handler,capture){wmatrixAddEventListener(evt,handler,capture);if(evt==="resume"&&lastResumeEvent){handler(lastResumeEvent)}};channel.onJSReady.subscribe(function(){exec(onMessageFromNative,APP_PLUGIN_NAME,"messageChannel",[]);exec(null,APP_PLUGIN_NAME,"show",[])})}};function onMessageFromNative(msg){var wmatrix=require("wmatrix");var action=msg.action;switch(action){case"backbutton":case"menubutton":case"searchbutton":case"pause":case"volumedownbutton":case"volumeupbutton":wmatrix.fireDocumentEvent(action);break;case"resume":if(arguments.length>1&&msg.pendingResult){if(arguments.length===2){msg.pendingResult.result=arguments[1]}else{var res=[];for(var i=1;i<arguments.length;i++){res.push(arguments[i])}msg.pendingResult.result=res}lastResumeEvent=msg}wmatrix.fireDocumentEvent(action,msg);break;default:throw new Error("Unknown event action "+action)}}});define("wmatrix/plugin/android/app",function(require,exports,module){var exec=require("wmatrix/exec");var APP_PLUGIN_NAME=Number(require("wmatrix").platformVersion.split(".")[2])>=6?"CoreAndroid":"App";module.exports={clearCache:function(){exec(null,APP_PLUGIN_NAME,"clearCache",[])},loadUrl:function(url,props){exec(null,APP_PLUGIN_NAME,"loadUrl",[url,props])},cancelLoadUrl:function(){exec(null,APP_PLUGIN_NAME,"cancelLoadUrl",[])},clearHistory:function(){exec(null,APP_PLUGIN_NAME,"clearHistory",[])},backHistory:function(){exec(null,APP_PLUGIN_NAME,"backHistory",[])},overrideBackbutton:function(override){exec(null,APP_PLUGIN_NAME,"overrideBackbutton",[override])},overrideButton:function(button,override){exec(null,APP_PLUGIN_NAME,"overrideButton",[button,override])},exitApp:function(){return exec(null,APP_PLUGIN_NAME,"exitApp",[])}}})}else{define("wmatrix/exec",function(require,exports,module){var wmatrix=require("wmatrix");var utils=require("wmatrix/utils");var base64=require("wmatrix/base64");function massageArgsJsToNative(args){if(!args||utils.typeName(args)!=="Array"){return args}var ret=[];args.forEach(function(arg,i){if(utils.typeName(arg)==="ArrayBuffer"){ret.push({WHType:"ArrayBuffer",data:base64.fromArrayBuffer(arg)})}else{ret.push(arg)}});return ret}function massageMessageNativeToJs(message){if(message.WHType==="ArrayBuffer"){var stringToArrayBuffer=function(str){var ret=new Uint8Array(str.length);for(var i=0;i<str.length;i++){ret[i]=str.charCodeAt(i)}return ret.buffer};var base64ToArrayBuffer=function(b64){return stringToArrayBuffer(atob(b64))};message=base64ToArrayBuffer(message.data)}return message}function convertMessageToArgsNativeToJs(message){var args=[];if(!message||!Object.prototype.hasOwnProperty.call(message,"WHType")){args.push(message)}else if(message.WHType==="MultiPart"){message.messages.forEach(function(e){args.push(massageMessageNativeToJs(e))})}else{args.push(massageMessageNativeToJs(message))}return args}var iOSExec=function(){var successCallback,failCallback,service,action,actionArgs;var callbackId=null;if(typeof arguments[0]!=="string"){callbackFunc=arguments[0];service=arguments[1];action=arguments[2];actionArgs=arguments[3];callbackId="INVALID"}else{throw new Error("The old format of this exec call has been removed (deprecated since 2.1). Change to: "+"wmatrix.exec(null, null, 'Service', 'action', [ arg1, arg2 ]);")}actionArgs=actionArgs||[];if(callbackFunc){callbackId=service+wmatrix.callbackId++;wmatrix.callbacks[callbackId]={callbackFunc:callbackFunc}}actionArgs=massageArgsJsToNative(actionArgs);var command=[callbackId,service,action,JSON.parse(JSON.stringify(actionArgs))];window.webkit.messageHandlers.wmatrix.postMessage(command)};iOSExec.nativeCallback=function(callbackId,message,keepCallback){var args=convertMessageToArgsNativeToJs(message);Promise.resolve().then(function(){wmatrix.callbackFromNative(callbackId,true,"",args,keepCallback)})};iOSExec.nativeEvalAndFetch=function(func){try{func()}catch(e){console.log(e)}};function wmatrixExec(){var cexec=require("wmatrix/exec");var cexec_valid=typeof cexec.nativeFetchMessages==="function"&&typeof cexec.nativeEvalAndFetch==="function"&&typeof cexec.nativeCallback==="function";return cexec_valid&&execProxy!==cexec?cexec:iOSExec}function execProxy(){wmatrixExec().apply(null,arguments)}execProxy.nativeFetchMessages=function(){return wmatrixExec().nativeFetchMessages.apply(null,arguments)};execProxy.nativeEvalAndFetch=function(){return wmatrixExec().nativeEvalAndFetch.apply(null,arguments)};execProxy.nativeCallback=function(){return wmatrixExec().nativeCallback.apply(null,arguments)};module.exports=execProxy});define("wmatrix/platform",function(require,exports,module){module.exports={id:"ios",bootstrap:function(){require("wmatrix/modulemapper").clobbers("wmatrix/plugin/ios/console","window.console");require("wmatrix/channel").onNativeReady.fire()}}});define("wmatrix/plugin/ios/console",function(require,exports,module){var logger=require("wmatrix/plugin/ios/logger");var console=module.exports;var WinConsole=window.console;var UseLogger=true;var Timers={};function noop(){}console.useLogger=function(value){if(arguments.length)UseLogger=!!value;if(UseLogger){if(logger.useConsole()){throw new Error("console and logger are too intertwingly")}}return UseLogger};console.log=function(){if(logger.useConsole())return;logger.log.apply(logger,[].slice.call(arguments))};console.error=function(){if(logger.useConsole())return;logger.error.apply(logger,[].slice.call(arguments))};console.warn=function(){if(logger.useConsole())return;logger.warn.apply(logger,[].slice.call(arguments))};console.info=function(){if(logger.useConsole())return;logger.info.apply(logger,[].slice.call(arguments))};console.debug=function(){if(logger.useConsole())return;logger.debug.apply(logger,[].slice.call(arguments))};console.assert=function(expression){if(expression)return;var message=logger.format.apply(logger.format,[].slice.call(arguments,1));console.log("ASSERT: "+message)};console.clear=function(){};console.dir=function(object){console.log("%o",object)};console.dirxml=function(node){console.log(node.innerHTML)};console.trace=noop;console.group=console.log;console.groupCollapsed=console.log;console.groupEnd=noop;console.time=function(name){Timers[name]=(new Date).valueOf()};console.timeEnd=function(name){var timeStart=Timers[name];if(!timeStart){console.warn("unknown timer: "+name);return}var timeElapsed=(new Date).valueOf()-timeStart;console.log(name+": "+timeElapsed+"ms")};console.timeStamp=noop;console.profile=noop;console.profileEnd=noop;console.count=noop;console.exception=console.log;console.table=function(data,columns){console.log("%o",data)};function wrappedOrigCall(orgFunc,newFunc){return function(){var args=[].slice.call(arguments);args.unshift("[WEB]");try{orgFunc.apply(WinConsole,args)}catch(e){}try{newFunc.apply(console,args)}catch(e){}}}for(var key in console){if(typeof WinConsole[key]==="function"){console[key]=wrappedOrigCall(WinConsole[key],console[key])}}});define("wmatrix/plugin/ios/logger",function(require,exports,module){var logger=exports;var exec=require("wmatrix/exec");var UseConsole=false;var UseLogger=true;var Queued=[];var WMatrixReady=false;var CurrentLevel;var originalConsole=console;var Levels=["LOG","ERROR","WARN","INFO","DEBUG"];var LevelsMap={};for(var i=0;i<Levels.length;i++){var level=Levels[i];LevelsMap[level]=i;logger[level]=level}CurrentLevel=LevelsMap.WARN;logger.level=function(value){if(arguments.length){if(LevelsMap[value]===null){throw new Error("invalid logging level: "+value)}CurrentLevel=LevelsMap[value]}return Levels[CurrentLevel]};logger.useConsole=function(value){if(arguments.length)UseConsole=!!value;if(UseConsole){if(typeof console==="undefined"){throw new Error("global console object is not defined")}if(typeof console.log!=="function"){throw new Error("global console object does not have a log function")}if(typeof console.useLogger==="function"){if(console.useLogger()){throw new Error("console and logger are too intertwingly")}}}return UseConsole};logger.useLogger=function(value){if(arguments.length)UseLogger=!!value;return UseLogger};logger.log=function(message){logWithArgs("LOG",arguments)};logger.error=function(message){logWithArgs("ERROR",arguments)};logger.warn=function(message){logWithArgs("WARN",arguments)};logger.info=function(message){logWithArgs("INFO",arguments)};logger.debug=function(message){logWithArgs("DEBUG",arguments)};function logWithArgs(level,args){args=[level].concat([].slice.call(args));logger.logLevel.apply(logger,args)}function formatStringForMessage(message){return typeof message==="string"?"":"%o"}logger.logLevel=function(level){var formatArgs=[].slice.call(arguments,1);var fmtString=formatStringForMessage(formatArgs[0]);if(fmtString.length>0){formatArgs.unshift(fmtString)}var message=logger.format.apply(logger.format,formatArgs);if(LevelsMap[level]===null){throw new Error("invalid logging level: "+level)}if(LevelsMap[level]>CurrentLevel)return;if(!WMatrixReady&&!UseConsole){Queued.push([level,message]);return}if(UseLogger){exec(null,"Console","logLevel",[level,message])}if(UseConsole){if(console.useLogger()){throw new Error("console and logger are too intertwingly")}switch(level){case logger.LOG:originalConsole.log(message);break;case logger.ERROR:originalConsole.log("ERROR: "+message);break;case logger.WARN:originalConsole.log("WARN: "+message);break;case logger.INFO:originalConsole.log("INFO: "+message);break;case logger.DEBUG:originalConsole.log("DEBUG: "+message);break}}};logger.format=function(formatString,args){return __format(arguments[0],[].slice.call(arguments,1)).join(" ")};function __format(formatString,args){if(formatString===null||formatString===undefined)return[""];if(arguments.length===1)return[formatString.toString()];if(typeof formatString!=="string"){formatString=formatString.toString()}var pattern=/(.*?)%(.)(.*)/;var rest=formatString;var result=[];while(args.length){var match=pattern.exec(rest);if(!match)break;var arg=args.shift();rest=match[3];result.push(match[1]);if(match[2]==="%"){result.push("%");args.unshift(arg);continue}result.push(__formatted(arg,match[2]))}result.push(rest);var remainingArgs=[].slice.call(args);remainingArgs.unshift(result.join(""));return remainingArgs}function __formatted(object,formatChar){try{switch(formatChar){case"j":case"o":return JSON.stringify(object);case"c":return""}}catch(e){return"error JSON.stringify()ing argument: "+e}if(object===null||object===undefined){return Object.prototype.toString.call(object)}return object.toString()}logger.__onWMatrixReady=function(){if(WMatrixReady)return;WMatrixReady=true;for(var i=0;i<Queued.length;i++){var messageArgs=Queued[i];logger.logLevel(messageArgs[0],messageArgs[1])}Queued=null};document.addEventListener("wmatrixready",logger.__onWMatrixReady,false)})}define("wmatrix/exec/proxy",function(require,exports,module){var CommandProxyMap={};module.exports={add:function(id,proxyObj){console.log("adding proxy for "+id);CommandProxyMap[id]=proxyObj;return proxyObj},remove:function(id){var proxy=CommandProxyMap[id];delete CommandProxyMap[id];CommandProxyMap[id]=null;return proxy},get:function(service,action){return CommandProxyMap[service]?CommandProxyMap[service][action]:null}}});define("wmatrix/init",function(require,exports,module){var channel=require("wmatrix/channel");var wmatrix=require("wmatrix");var modulemapper=require("wmatrix/modulemapper");var platform=require("wmatrix/platform");var pluginloader=require("wmatrix/pluginloader");var utils=require("wmatrix/utils");var platformInitChannelsArray=[channel.onNativeReady,channel.onPluginsReady];function logUnfiredChannels(arr){for(var i=0;i<arr.length;++i){if(arr[i].state!==2){console.log("Channel not fired: "+arr[i].type)}}}window.setTimeout(function(){if(channel.onWMatrixReady.state!==2){console.log("wmatrixready has not fired after 5 seconds.");logUnfiredChannels(platformInitChannelsArray);logUnfiredChannels(channel.wmatrixReadyChannelsArray)}},5e3);function replaceNavigator(origNavigator){var wMatrixNavigator=function(){};wMatrixNavigator.prototype=origNavigator;var newNavigator=new wMatrixNavigator;if(wMatrixNavigator.bind){for(var key in origNavigator){if(typeof origNavigator[key]==="function"){newNavigator[key]=origNavigator[key].bind(origNavigator)}else{(function(k){utils.defineGetterSetter(newNavigator,key,function(){return origNavigator[k]})})(key)}}}return newNavigator}if(window.navigator){window.navigator=replaceNavigator(window.navigator)}if(!window.console){window.console={log:function(){}}}if(!window.console.warn){window.console.warn=function(msg){this.log("warn: "+msg)}}channel.onPause=wmatrix.addDocumentEventHandler("pause");channel.onResume=wmatrix.addDocumentEventHandler("resume");channel.onActivated=wmatrix.addDocumentEventHandler("activated");channel.onWMatrixReady=wmatrix.addStickyDocumentEventHandler("wmatrixready");if(document.readyState==="complete"||document.readyState==="interactive"){channel.onDOMContentLoaded.fire()}else{document.addEventListener("DOMContentLoaded",function(){channel.onDOMContentLoaded.fire()},false)}if(window._nativeReady){channel.onNativeReady.fire()}modulemapper.clobbers("wmatrix","wmatrix");modulemapper.clobbers("wmatrix/exec","wmatrix.exec");platform.bootstrap&&platform.bootstrap();setTimeout(function(){pluginloader.load(function(){channel.onPluginsReady.fire()})},0);channel.join(function(){modulemapper.mapModules(window);platform.initialize&&platform.initialize();channel.onJSReady.fire();channel.join(function(){require("wmatrix").fireDocumentEvent("wmatrixready")},channel.wmatrixReadyChannelsArray)},platformInitChannelsArray)});define("wmatrix/modulemapper",function(require,exports,module){var builder=require("wmatrix/builder");var moduleMap=define.moduleMap;var symbolList;var deprecationMap;exports.reset=function(){symbolList=[];deprecationMap={}};function addEntry(strategy,moduleName,symbolPath,opt_deprecationMessage){if(!(moduleName in moduleMap)){throw new Error("Module "+moduleName+" does not exist.")}symbolList.push(strategy,moduleName,symbolPath);if(opt_deprecationMessage){deprecationMap[symbolPath]=opt_deprecationMessage}}exports.clobbers=function(moduleName,symbolPath,opt_deprecationMessage){addEntry("c",moduleName,symbolPath,opt_deprecationMessage)};exports.merges=function(moduleName,symbolPath,opt_deprecationMessage){addEntry("m",moduleName,symbolPath,opt_deprecationMessage)};exports.defaults=function(moduleName,symbolPath,opt_deprecationMessage){addEntry("d",moduleName,symbolPath,opt_deprecationMessage)};exports.runs=function(moduleName){addEntry("r",moduleName,null)};function prepareNamespace(symbolPath,context){if(!symbolPath){return context}return symbolPath.split(".").reduce(function(cur,part){return cur[part]=cur[part]||{}},context)}exports.mapModules=function(context){var origSymbols={};context.WMatrix_origSymbols=origSymbols;for(var i=0,len=symbolList.length;i<len;i+=3){var strategy=symbolList[i];var moduleName=symbolList[i+1];var module=require(moduleName);if(strategy==="r"){continue}var symbolPath=symbolList[i+2];var lastDot=symbolPath.lastIndexOf(".");var namespace=symbolPath.substr(0,lastDot);var lastName=symbolPath.substr(lastDot+1);var deprecationMsg=symbolPath in deprecationMap?"Access made to deprecated symbol: "+symbolPath+". "+deprecationMsg:null;var parentObj=prepareNamespace(namespace,context);var target=parentObj[lastName];if(strategy==="m"&&target){builder.recursiveMerge(target,module)}else if(strategy==="d"&&!target||strategy!=="d"){if(!(symbolPath in origSymbols)){origSymbols[symbolPath]=target}builder.assignOrWrapInDeprecateGetter(parentObj,lastName,module,deprecationMsg)}}};exports.getOriginalSymbol=function(context,symbolPath){var origSymbols=context.WMatrix_origSymbols;if(origSymbols&&symbolPath in origSymbols){return origSymbols[symbolPath]}var parts=symbolPath.split(".");var obj=context;for(var i=0;i<parts.length;++i){obj=obj&&obj[parts[i]]}return obj};exports.reset()});define("wmatrix/pluginloader",function(require,exports,module){var modulemapper=require("wmatrix/modulemapper");exports.injectScript=function(url,onload,onerror){var script=document.createElement("script");script.onload=onload;script.onerror=onerror;script.src=url;document.head.appendChild(script)};function injectIfNecessary(id,url,onload,onerror){onerror=onerror||onload;if(id in define.moduleMap){onload()}else{exports.injectScript(url,function(){if(id in define.moduleMap){onload()}else{onerror()}},onerror)}}function onScriptLoadingComplete(moduleList,finishPluginLoading){for(var i=0,module;module=moduleList[i];i++){if(module.clobbers&&module.clobbers.length){for(var j=0;j<module.clobbers.length;j++){modulemapper.clobbers(module.id,module.clobbers[j])}}if(module.merges&&module.merges.length){for(var k=0;k<module.merges.length;k++){modulemapper.merges(module.id,module.merges[k])}}if(module.runs){modulemapper.runs(module.id)}}finishPluginLoading()}function handlePluginsObject(path,moduleList,finishPluginLoading){var scriptCounter=moduleList.length;if(!scriptCounter){finishPluginLoading();return}function scriptLoadedCallback(){if(!--scriptCounter){onScriptLoadingComplete(moduleList,finishPluginLoading)}}for(var i=0;i<moduleList.length;i++){injectIfNecessary(moduleList[i].id,path+moduleList[i].file,scriptLoadedCallback)}}function findWMatrixPath(){var path=null;var scripts=document.getElementsByTagName("script");var term="/wmatrix.js";for(var n=scripts.length-1;n>-1;n--){var src=scripts[n].src.replace(/\?.*$/,"");if(src.indexOf(term)===src.length-term.length){path=src.substring(0,src.length-term.length)+"/";break}}return path}exports.load=function(callback){var pathPrefix=findWMatrixPath();if(pathPrefix===null){console.log("Could not find wmatrix.js script tag. Plugin loading may fail.");pathPrefix=""}injectIfNecessary("wmatrix/plugin_list",pathPrefix+"wmatrix_plugins.js",function(){var moduleList=require("wmatrix/plugin_list");handlePluginsObject(pathPrefix,moduleList,callback)},callback)}});define("wmatrix/urlutil",function(require,exports,module){exports.makeAbsolute=function makeAbsolute(url){var anchorEl=document.createElement("a");anchorEl.href=url;return anchorEl.href}});define("wmatrix/utils",function(require,exports,module){var utils=exports;utils.defineGetterSetter=function(obj,key,getFunc,opt_setFunc){if(Object.defineProperty){var desc={get:getFunc,configurable:true};if(opt_setFunc){desc.set=opt_setFunc}Object.defineProperty(obj,key,desc)}else{obj.__defineGetter__(key,getFunc);if(opt_setFunc){obj.__defineSetter__(key,opt_setFunc)}}};utils.defineGetter=utils.defineGetterSetter;utils.arrayIndexOf=function(a,item){if(a.indexOf){return a.indexOf(item)}var len=a.length;for(var i=0;i<len;++i){if(a[i]===item){return i}}return-1};utils.arrayRemove=function(a,item){var index=utils.arrayIndexOf(a,item);if(index!==-1){a.splice(index,1)}return index!==-1};utils.typeName=function(val){return Object.prototype.toString.call(val).slice(8,-1)};utils.isArray=Array.isArray||function(a){return utils.typeName(a)==="Array"};utils.isDate=function(d){return d instanceof Date};utils.clone=function(obj){if(!obj||typeof obj==="function"||utils.isDate(obj)||typeof obj!=="object"){return obj}var retVal,i;if(utils.isArray(obj)){retVal=[];for(i=0;i<obj.length;++i){retVal.push(utils.clone(obj[i]))}return retVal}retVal={};for(i in obj){if((!(i in retVal)||retVal[i]!==obj[i])&&typeof obj[i]!=="undefined"&&typeof obj[i]!=="unknown"){retVal[i]=utils.clone(obj[i])}}return retVal};utils.close=function(context,func,params){return function(){var args=params||arguments;return func.apply(context,args)}};function UUIDcreatePart(length){var uuidpart="";for(var i=0;i<length;i++){var uuidchar=parseInt(window.crypto.getRandomValues(new Uint8Array(1))[0],10).toString(16);if(uuidchar.length===1){uuidchar="0"+uuidchar}uuidpart+=uuidchar}return uuidpart}utils.createUUID=function(){return UUIDcreatePart(4)+"-"+UUIDcreatePart(2)+"-"+UUIDcreatePart(2)+"-"+UUIDcreatePart(2)+"-"+UUIDcreatePart(6)};utils.extend=function(){var F=function(){};return function(Child,Parent){F.prototype=Parent.prototype;Child.prototype=new F;Child.__super__=Parent.prototype;Child.prototype.constructor=Child}}();utils.alert=function(msg){if(window.alert){window.alert(msg)}else if(console&&console.log){console.log(msg)}}});window.wmatrix=require("wmatrix");require("wmatrix/init")})();